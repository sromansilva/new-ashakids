<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/adminLayout :: Head}"></head>

<body>

  <div class="d-flex" style="min-height: 100vh;">

    <div th:replace="~{fragments/adminLayout :: menuToggle}"></div>

    <div th:replace="~{fragments/adminLayout :: sidebarAdmin}"></div>

    <div th:replace="~{fragments/adminLayout :: overlay}"></div>

    <!-- Contenido principal -->
    <main class="content-area">
      <!-- Contenido principal -->
      <div class="flex-grow-1 p-4">
        <h2>Panel de Control <span class="text-primary fw-bold" th:text="${admin.nombre}">Administrador</span> 游늵</h2>
        <p class="text-muted">Monitoreo en tiempo real del sistema:</p>

        <!-- Estad칤sticas principales -->
        <div class="row mb-4">
          <div class="col-md-3 mb-3">
            <div class="card border-start border-primary border-4 shadow-sm">
              <div class="card-body d-flex align-items-center">
                <i class="fas fa-eye fa-2x text-primary me-3"></i>
                <div>
                  <h6 class="mb-0">Visitas Totales</h6>
                  <p class="text-muted mb-0" th:text="${visitasTotales}">1,247</p>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="card border-start border-success border-4 shadow-sm">
              <div class="card-body d-flex align-items-center">
                <i class="fas fa-users fa-2x text-success me-3"></i>
                <div>
                  <h6 class="mb-0">Usuarios Activos</h6>
                  <p class="text-muted mb-0" th:text="${usuariosActivos}">89</p>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="card border-start border-warning border-4 shadow-sm">
              <div class="card-body d-flex align-items-center">
                <i class="fas fa-clock fa-2x text-warning me-3"></i>
                <div>
                  <h6 class="mb-0">Tiempo Promedio</h6>
                  <p class="text-muted mb-0" th:text="${tiempoPromedio}">12 min</p>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="card border-start border-info border-4 shadow-sm">
              <div class="card-body d-flex align-items-center">
                <i class="fas fa-chart-line fa-2x text-info me-3"></i>
                <div>
                  <h6 class="mb-0">Crecimiento</h6>
                  <p class="text-muted mb-0" th:text="${crecimiento}">+15%</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Gr치ficos de actividad -->
        <div class="row mb-4">
          <div class="col-md-8 mb-4">
            <div class="card shadow-sm">
              <div class="card-header">
                <h6 class="mb-0">Actividad de la P치gina (칔ltimos 7 d칤as)</h6>
              </div>
              <div class="card-body">
                <canvas id="activityChart" height="100"></canvas>
              </div>
            </div>
          </div>
          <div class="col-md-4 mb-4">
            <div class="card shadow-sm">
              <div class="card-header">
                <h6 class="mb-0">Distribuci칩n de Visitas</h6>
              </div>
              <div class="card-body">
                <canvas id="visitsChart" height="200"></canvas>
              </div>
            </div>
          </div>
        </div>

        <!-- Tabla de actividad reciente -->
        <div class="row">
          <div class="col-12">
            <div class="card shadow-sm">
              <div class="card-header">
                <h6 class="mb-0">Actividad Reciente</h6>
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-hover">
                    <thead>
                      <tr>
                        <th>Usuario</th>
                        <th>Acci칩n</th>
                        <th>P치gina</th>
                        <th>Hora</th>
                        <th>Duraci칩n</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr th:each="actividad : ${actividadesRecientes}">
                        <td th:text="${actividad.usuario}">Ana Garc칤a</td>
                        <td th:text="${actividad.accion}">Inici칩 sesi칩n</td>
                        <td th:text="${actividad.pagina}">Dashboard</td>
                        <td th:text="${actividad.hora}">14:30</td>
                        <td th:text="${actividad.duracion}">5 min</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
  </div>
  </main>


  <!-- Scripts -->
  <script>
    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('show');
      document.querySelector('.sidebar-backdrop').classList.toggle('show');
    }

    // Gr치fico de actividad
    const activityCtx = document.getElementById('activityChart').getContext('2d');
    new Chart(activityCtx, {
      type: 'line',
      data: {
        labels: ['Lun', 'Mar', 'Mi칠', 'Jue', 'Vie', 'S치b', 'Dom'],
        datasets: [{
          label: 'Visitas',
          data: [120, 150, 180, 200, 175, 220, 190],
          borderColor: '#4e73df',
          backgroundColor: 'rgba(78, 115, 223, 0.1)',
          tension: 0.4
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false } },
        scales: { y: { beginAtZero: true } }
      }
    });

    // Gr치fico de distribuci칩n de visitas
    const visitsCtx = document.getElementById('visitsChart').getContext('2d');
    new Chart(visitsCtx, {
      type: 'doughnut',
      data: {
        labels: ['Padres', 'Terapeutas', 'Ni침os', 'Visitantes'],
        datasets: [{
          data: [40, 25, 20, 15],
          backgroundColor: ['#36b9cc', '#f6c23e', '#1cc88a', '#e74a3b']
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { position: 'bottom' } }
      }
    });
  </script>
  <div th:replace="~{fragments/adminLayout :: admin-scripts}"></div>
</body>

</html>